```java
import java.util.*;

class Solution {
    public int[] solution(int[] fees, String[] records) {
        int[] answer = {};
        final int dTime = fees[0];
        final int dCharge = fees[1];
        final int uTime = fees[2];
        final int uCharge = fees[3];
        final String lastTime = "23:59";

        final Map<String, String> map = new HashMap<>();
        final Map<String, Integer> intMap = new HashMap<>();
        for (String record : records) {
            final StringTokenizer st = new StringTokenizer(record);
            final String time = st.nextToken();
            final String car = st.nextToken();
            final String inAndOut = st.nextToken();

            if ("IN".equals(inAndOut))
                map.put(car, time);
            else {
                String[] in = map.remove(car).split(":");
                String[] out = time.split(":");

                if (intMap.containsKey(car)) {
                    int total = intMap.remove(car) + getTime(in, out);
                    intMap.put(car, total);
                } else {
                    intMap.put(car, getTime(in, out));
                }
            }
        }

        if (map.size() > 0) {
            map.forEach((car, time) -> {
                String[] in = time.split(":");
                String[] out = lastTime.split(":");
                if (intMap.containsKey(car)) {
                    int total = intMap.remove(car) + getTime(in, out);
                    intMap.put(car, total);
                } else {
                    intMap.put(car, getTime(in, out));
                }
            });
        }

        final ArrayList<String> carList = new ArrayList<>(intMap.keySet());
        carList.sort(String::compareTo);

        int[] array = carList.stream()
                    .mapToInt(car -> {
                        Integer time = intMap.get(car);
                        if (time - dTime <= 0)
                            return dCharge;

                        int totalTime = time - dTime;

                        int pay = (totalTime / uTime) * uCharge;
                        if ((time - dTime) % uTime > 0)
                            pay += uCharge;

                        return pay + dCharge;
                    }).toArray();

        return array;
    }

    private int getTime(String[] in, String[] out) {
        int enterH = Integer.parseInt(in[0]);
        int enterM = Integer.parseInt(in[1]);
        int outH = Integer.parseInt(out[0]);
        int outM = Integer.parseInt(out[1]);

        int hour = (outH - enterH) * 60;
        int minute = outM - enterM;

        return hour + minute;
    }
}
```

<img width="293" alt="스크린샷 2023-05-05 오후 3 43 22" src="https://user-images.githubusercontent.com/82895809/236392387-f04a9818-b747-45c0-aa6c-c95dea891ad2.png">
